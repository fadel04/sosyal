import{i as x,Q as N,m as c,p as B,n as z,l as S,o as ee,k as I,C as U}from"./useApi-BvUqY1tE.js";import{Q as M,a as k,b as A}from"./QItem-BTUWoWEx.js";import{g as te,Q as u,a as F,b as ae}from"./QBtn-DYZTwiAx.js";import{c as oe,a as q,h as n,_ as le,y as se,A as r,B as g,C as o,E as s,D as a,G as d,F as C,H as y,J as h,O as ne,Q as re,R as ie,I as L,x as P}from"./index-Do2U6s1M.js";import{Q as de}from"./QList-DgcBrpoB.js";import{Q as ue}from"./QPage-Dcfz10FS.js";import"./dom-yNob52VE.js";import"./scroll-BnXb6wY2.js";import"./axios-CrDRZsLl.js";import"./useAuthToken-DmPVqjwS.js";const me=oe({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:t}){const m=q(()=>e.sent===!0?"sent":"received"),w=q(()=>`q-message-text-content q-message-text-content--${m.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),Q=q(()=>`q-message-text q-message-text--${m.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),V=q(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),l=q(()=>e.size!==void 0?`col-${e.size}`:""),b=q(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function D(i){return t.stamp!==void 0?[i,n("div",{class:"q-message-stamp"},t.stamp())]:e.stamp?[i,n("div",{class:"q-message-stamp",[b.value.stamp]:e.stamp})]:[i]}function $(i,p){const v=p===!0?i.length>1?f=>f:f=>n("div",[f]):f=>n("div",{[b.value.msg]:f});return i.map((f,H)=>n("div",{key:H,class:Q.value},[n("div",{class:w.value},D(v(f)))]))}return()=>{const i=[];t.avatar!==void 0?i.push(t.avatar()):e.avatar!==void 0&&i.push(n("img",{class:`q-message-avatar q-message-avatar--${m.value}`,src:e.avatar,"aria-hidden":"true"}));const p=[];t.name!==void 0?p.push(n("div",{class:`q-message-name q-message-name--${m.value}`},t.name())):e.name!==void 0&&p.push(n("div",{class:`q-message-name q-message-name--${m.value}`,[b.value.name]:e.name})),t.default!==void 0?p.push($(te(t.default()),!0)):e.text!==void 0&&p.push($(e.text)),i.push(n("div",{class:l.value},p));const v=[];return t.label!==void 0?v.push(n("div",{class:"q-message-label"},t.label())):e.label!==void 0&&v.push(n("div",{class:"q-message-label",[b.value.label]:e.label})),v.push(n("div",{class:V.value},i)),n("div",{class:`q-message q-message-${m.value}`},v)}}}),pe=se({name:"IndexPage",setup(){const{getPosts:e,posts:t,postComments:m,getUser:w,user:Q,apiUrl:V,limit:l,performSearch:b,getPost:D,post:$,opp:i,urlParams:p,id:v,comments:f,author:H,commentForm:T,createComment:K,postData:O,updatePost:J,error:R,idBul:E,loading:G,res:Y,edit:j,confirm:W,deletePost:X,alert:Z,getIdUser:_}=x();return D(),{getPosts:e,posts:t,postComments:m,getUser:w,user:Q,apiUrl:V,limit:l,performSearch:b,opp:i,urlParams:p,id:v,post:$,comments:f,author:H,commentForm:T,createComment:K,postData:O,updatePost:J,error:R,idBul:E,loading:G,res:Y,edit:j,confirm:W,alert:Z,deletePost:X,getIdUser:_}}}),fe={class:"q-pa-sm row items-start q-gutter-md"},ge={id:"posts"},ve=["src"],ce=["src"],Ce={align:"right"},ye={class:"q-ma-none q-pa-sm"},be={class:"q-ma-none text-grey",style:{"font-size":"10px"}},qe={class:"q-mr-xs"},ke={style:{"word-break":"break-word","overflow-wrap":"break-word"}},he={key:0,style:{color:"green"}},we={key:1},Qe={key:0,style:{color:"green"}},Ve={key:1};function $e(e,t,m,w,Q,V){return r(),g(ue,{class:"column flex-center bg-blue-grey-2"},{default:o(()=>[s("div",fe,[s("div",ge,[a(S,{class:"my-card shadow-4"},{default:o(()=>[a(M,null,{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(N,{class:"overlapping",style:{cursor:"pointer"},onClick:t[0]||(t[0]=l=>e.getIdUser(e.author.id))},{default:o(()=>[s("img",{src:e.author.profile_image},null,8,ve)]),_:1})]),_:1}),a(k,null,{default:o(()=>[a(A,{style:{cursor:"pointer"},onClick:t[1]||(t[1]=l=>e.getIdUser(e.author.id))},{default:o(()=>[s("b",null,d(e.author.name),1)]),_:1}),a(A,{caption:""},{default:o(()=>[C(d(e.author.username),1)]),_:1})]),_:1})]),_:1}),s("img",{style:{height:"350px"},src:e.post.image},null,8,ce),a(c,{class:"q-px-xs q-ma-none q-pt-none"},{default:o(()=>[a(k,{class:"q-px-xs q-ma-none q-pt-none"},{default:o(()=>[a(A,null,{default:o(()=>[a(B,{class:"q-px-xs q-ma-none q-pt-none"},{default:o(()=>[e.post.comments_count==0?(r(),g(u,{key:0,flat:"",round:"",color:"red",icon:"favorite"},{default:o(()=>[C(d(e.postComments),1)]),_:1})):(r(),g(u,{key:1,flat:"",round:"",color:"red",icon:"favorite"},{default:o(()=>[C(d(e.post.comments_count),1)]),_:1})),e.post.comments_count==0?(r(),g(u,{key:2,flat:"",round:"",color:"accent",icon:"comment"},{default:o(()=>[C(d(e.postComments),1)]),_:1})):(r(),g(u,{key:3,flat:"",round:"",color:"accent",icon:"comment"},{default:o(()=>[C(d(e.post.comments_count),1)]),_:1})),a(k,null,{default:o(()=>[s("div",Ce,[e.user!=null&&e.author.id==e.user.id?(r(),g(u,{key:0,flat:"",onClick:t[2]||(t[2]=l=>(e.edit=!0,e.idBul(`${encodeURIComponent(JSON.stringify(e.post))}`))),rounded:"",icon:"edit"})):y("",!0),e.user!=null&&e.author.id==e.user.id?(r(),g(u,{key:1,flat:"",onClick:t[3]||(t[3]=l=>(e.confirm=!0,e.open("top"),e.idBul(`${encodeURIComponent(JSON.stringify(e.post))}`))),rounded:"",icon:"delete",color:"red"})):y("",!0)])]),_:1})]),_:1})]),_:1}),s("div",ye,[s("span",be,d(e.post.created_at),1),s("p",null,[s("b",qe,d(e.author.username),1),s("span",ke,d(e.post.body),1)])])]),_:1})]),_:1}),a(k),a(c,null,{default:o(()=>[a(de,{separator:""},{default:o(()=>[(r(!0),h(re,null,ne(e.comments,l=>(r(),g(M,{key:l,name:l},{default:o(()=>[a(me,{name:l.author.name,avatar:l.author.profile_image,text:[l.body],size:"8","text-color":"white","bg-color":"grey"},null,8,["name","avatar","text"])]),_:2},1032,["name"]))),128))]),_:1})]),_:1}),a(c,null,{default:o(()=>[a(z,{modelValue:e.commentForm.newComment,"onUpdate:modelValue":t[4]||(t[4]=l=>e.commentForm.newComment=l),placeholder:"add your comment here",outlined:"",dense:"",clearable:"",onKeyup:ie(e.createComment,["enter"])},{append:o(()=>[a(u,{icon:"send",round:"",dense:"",flat:"",color:"primary",onClick:e.createComment},null,8,["onClick"])]),_:1},8,["modelValue","onKeyup"]),e.res?(r(),h("p",he,[s("b",null,d(e.res),1)])):y("",!0),e.error?(r(),h("p",we,[s("b",null,d(e.error),1)])):y("",!0)]),_:1})]),_:1}),a(I,{modelValue:e.edit,"onUpdate:modelValue":t[9]||(t[9]=l=>e.edit=l),persistent:""},{default:o(()=>[a(S,{style:{"min-width":"30%"}},{default:o(()=>[a(c,null,{default:o(()=>t[12]||(t[12]=[s("div",{class:"text-h6"},"Update the Post",-1)])),_:1}),a(c,{align:"center",class:"q-pt-none"},{default:o(()=>[a(z,{outlined:"",autogrow:"",type:"textarea",label:"Body",modelValue:e.postData.body,"onUpdate:modelValue":t[5]||(t[5]=l=>e.postData.body=l),autofocus:""},null,8,["modelValue"]),a(ee,{filled:"","bottom-slots":"",modelValue:e.postData.image,"onUpdate:modelValue":t[8]||(t[8]=l=>e.postData.image=l),accept:"image/*",label:"Add image",counter:""},{prepend:o(()=>[a(F,{name:"cloud_upload",onClick:t[6]||(t[6]=L(()=>{},["stop","prevent"]))})]),append:o(()=>[a(F,{name:"close",onClick:t[7]||(t[7]=L(l=>e.form.image=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:o(()=>[e.res?(r(),h("p",Qe,[s("b",null,d(e.res),1)])):y("",!0),e.error?(r(),h("p",Ve,[s("b",null,d(e.error),1)])):y("",!0)]),_:1},8,["modelValue"])]),_:1}),a(B,{align:"right",class:"text-primary"},{default:o(()=>[P(a(u,{flat:"",class:"text-grey-8",label:"Cancel"},null,512),[[U]]),a(u,{color:"brown",onClick:e.updatePost},{default:o(()=>[t[13]||(t[13]=C("Update post ")),e.loading?(r(),g(ae,{key:0,class:"q-ml-sm"})):y("",!0)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(I,{modelValue:e.confirm,"onUpdate:modelValue":t[10]||(t[10]=l=>e.confirm=l),persistent:""},{default:o(()=>[a(S,null,{default:o(()=>[a(c,{class:"row items-center"},{default:o(()=>[a(N,{icon:"error",color:"red","text-color":"white"}),t[14]||(t[14]=s("span",{class:"q-ml-sm"},"Are you sure you want to delete the post?",-1))]),_:1}),a(B,{align:"right"},{default:o(()=>[P(a(u,{squre:"",label:"Cancel",color:"grey"},null,512),[[U]]),P(a(u,{squre:"",label:"Yes, Delete",onClick:e.deletePost,color:"red"},null,8,["onClick"]),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(I,{modelValue:e.alert,"onUpdate:modelValue":t[11]||(t[11]=l=>e.alert=l),style:{width:"50%"}},{default:o(()=>[a(S,null,{default:o(()=>[a(c,null,{default:o(()=>t[15]||(t[15]=[s("div",{class:"text-h6"},"Alert",-1)])),_:1}),a(c,{class:"q-pt-none"},{default:o(()=>t[16]||(t[16]=[C(" Deleted post ")])),_:1}),a(B,{align:"right"},{default:o(()=>[P(a(u,{flat:"",label:"OK",color:"primary"},null,512),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}const Me=le(pe,[["render",$e],["__scopeId","data-v-e9a8e62e"],["__file","PostDetails.vue"]]);export{Me as default};
