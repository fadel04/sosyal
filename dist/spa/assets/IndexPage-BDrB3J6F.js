import{i as re,l as L,m as q,n as se,o as ie,p as M,k as F,Q as Y,C as R}from"./useApi-BvUqY1tE.js";import{Q as ue,a as $,b as z}from"./QItem-BTUWoWEx.js";import{u as de,c as ce,a as X,Q as v,b as fe}from"./QBtn-DYZTwiAx.js";import{c as ae,h as W,r as A,a as Z,w as N,K as me,L as ve,o as ge,u as pe,M as be,v as ee,N as ye,g as he,_ as Ce,y as ke,A as c,B as p,C as l,E as s,D as a,J,O as we,Q as qe,I as te,G as g,H as U,x as j,F as C}from"./index-Do2U6s1M.js";import{a as Se,h as Ie,c as le}from"./dom-yNob52VE.js";import{s as Qe,g as E,a as K,b as G,c as _e}from"./scroll-BnXb6wY2.js";import{Q as Pe}from"./QPage-Dcfz10FS.js";import"./axios-CrDRZsLl.js";import"./useAuthToken-DmPVqjwS.js";const Ve='<circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity=".3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from=".5" to=".5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',Ne=ae({name:"QSpinnerDots",props:de,setup(e){const{cSize:o,classes:w}=ce(e);return()=>W("svg",{class:w.value,fill:"currentColor",width:o.value,height:o.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",innerHTML:Ve})}}),{passive:k}=be,Ue=ae({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:Qe,initialIndex:{type:Number,default:0},disable:Boolean,reverse:Boolean},emits:["load"],setup(e,{slots:o,emit:w}){const d=A(!1),i=A(!0),b=A(null),t=A(null);let f=e.initialIndex,n,u;const T=Z(()=>"q-infinite-scroll__loading"+(d.value===!0?"":" invisible"));function y(){if(e.disable===!0||d.value===!0||i.value===!1)return;const r=E(n),m=K(n),V=le(n);e.reverse===!1?Math.round(m+V+e.offset)>=Math.round(r)&&S():Math.round(m)<=e.offset&&S()}function S(){if(e.disable===!0||d.value===!0||i.value===!1)return;f++,d.value=!0;const r=E(n);w("load",f,m=>{i.value===!0&&(d.value=!1,ee(()=>{if(e.reverse===!0){const V=E(n),oe=K(n),ne=V-r;G(n,oe+ne)}m===!0?I():b.value&&b.value.closest("body")&&u()}))})}function H(){f=0}function B(){i.value===!1&&(i.value=!0,n.addEventListener("scroll",u,k)),y()}function I(){i.value===!0&&(i.value=!1,d.value=!1,n.removeEventListener("scroll",u,k),u!==void 0&&u.cancel!==void 0&&u.cancel())}function h(){if(n&&i.value===!0&&n.removeEventListener("scroll",u,k),n=_e(b.value,e.scrollTarget),i.value===!0){if(n.addEventListener("scroll",u,k),e.reverse===!0){const r=E(n),m=le(n);G(n,r-m)}y()}}function O(r){f=r}function D(r){r=parseInt(r,10);const m=u;u=r<=0?y:ye(y,isNaN(r)===!0?100:r),n&&i.value===!0&&(m!==void 0&&n.removeEventListener("scroll",m,k),n.addEventListener("scroll",u,k))}function Q(r){if(_.value===!0){if(t.value===null){r!==!0&&ee(()=>{Q(!0)});return}const m=`${d.value===!0?"un":""}pauseAnimations`;Array.from(t.value.getElementsByTagName("svg")).forEach(V=>{V[m]()})}}const _=Z(()=>e.disable!==!0&&i.value===!0);N([d,_],()=>{Q()}),N(()=>e.disable,r=>{r===!0?I():B()}),N(()=>e.reverse,()=>{d.value===!1&&i.value===!0&&y()}),N(()=>e.scrollTarget,h),N(()=>e.debounce,D);let P=!1;me(()=>{P!==!1&&n&&G(n,P)}),ve(()=>{P=n?K(n):!1}),ge(()=>{i.value===!0&&n.removeEventListener("scroll",u,k)}),pe(()=>{D(e.debounce),h(),d.value===!1&&Q()});const x=he();return Object.assign(x.proxy,{poll:()=>{u!==void 0&&u()},trigger:S,stop:I,reset:H,resume:B,setIndex:O,updateScrollTarget:h}),()=>{const r=Se(o.default,[]);return _.value===!0&&r[e.reverse===!1?"push":"unshift"](W("div",{ref:t,class:T.value},Ie(o.loading))),W("div",{class:"q-infinite-scroll",ref:b},r)}}}),Be=ke({name:"IndexPage",setup(){const{getPosts:e,posts:o,postComments:w,getUser:d,user:i,apiUrl:b,limit:t,opp:f,edit:n,createPost:u,postData:T,error:y,loading:S,res:H,id:B,updatePost:I,postUp:h,idBul:O,deletePost:D,confirm:Q,alert:_,getIdUser:P}=re(),x=h.value.body,r=h.value.image;return{getPosts:e,posts:o,postComments:w,getUser:d,user:i,apiUrl:b,limit:t,opp:f,edit:n,id:B,createPost:u,postData:T,updatePost:I,error:y,loading:S,res:H,postUp:h,body:x,bodyImage:r,idBul:O,deletePost:D,confirm:Q,alert:_,getIdUser:P}}}),De={class:"q-pa-sm row items-start q-gutter-md"},Le={id:"posts"},Me=["src"],$e=["src","onClick"],Ae={align:"right"},Ee={class:"q-ma-none q-pa-sm"},Te={class:"q-ma-none text-grey",style:{"font-size":"10px"}},He={class:"q-mr-xs"},Oe={style:{"word-break":"break-word","overflow-wrap":"break-word"}},xe={class:"row justify-center q-my-md"},Fe={key:0,style:{color:"green"}},Re={key:1};function ze(e,o,w,d,i,b){return c(),p(Pe,{class:"column flex-center bg-blue-grey-2"},{default:l(()=>[s("div",De,[s("div",Le,[a(Ue,{onLoad:e.getPosts},{loading:l(()=>[s("div",xe,[a(Ne,{color:"brown",size:"40px"})])]),default:l(()=>[(c(!0),J(qe,null,we(e.posts,t=>(c(),p(L,{class:"my-card shadow-4",key:t,name:t},{default:l(()=>[a(ue,null,{default:l(()=>[a($,{avatar:""},{default:l(()=>[a(Y,{class:"overlapping",style:{cursor:"pointer"},onClick:f=>e.getIdUser(t.author.id)},{default:l(()=>[s("img",{src:t.author.profile_image},null,8,Me)]),_:2},1032,["onClick"])]),_:2},1024),a($,null,{default:l(()=>[a(z,{style:{cursor:"pointer"},onClick:f=>e.getIdUser(t.author.id)},{default:l(()=>[s("b",null,g(t.author.name),1)]),_:2},1032,["onClick"]),a(z,{caption:""},{default:l(()=>[C(g(t.author.username),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),s("img",{style:{height:"350px",cursor:"pointer"},src:t.image,onClick:f=>e.opp(t.id)},null,8,$e),a(q,{class:"q-px-none q-ma-none q-pt-none"},{default:l(()=>[a($,{class:"q-px-xs q-ma-none q-pt-none"},{default:l(()=>[a(z,null,{default:l(()=>[a(M,{class:"q-px-xs q-ma-none q-pt-none"},{default:l(()=>[t.comments_count==0?(c(),p(v,{key:0,flat:"",round:"",color:"red",icon:"favorite"},{default:l(()=>[C(g(e.postComments),1)]),_:1})):(c(),p(v,{key:1,flat:"",round:"",color:"red",icon:"favorite"},{default:l(()=>[C(g(t.comments_count),1)]),_:2},1024)),t.comments_count==0?(c(),p(v,{key:2,flat:"",round:"",color:"accent",icon:"comment"},{default:l(()=>[C(g(e.postComments),1)]),_:1})):(c(),p(v,{key:3,flat:"",round:"",color:"accent",icon:"comment"},{default:l(()=>[C(g(t.comments_count),1)]),_:2},1024)),a($,null,{default:l(()=>[s("div",Ae,[e.user!=null&&t.author.id==e.user.id?(c(),p(v,{key:0,flat:"",onClick:f=>(e.edit=!0,e.idBul(`${encodeURIComponent(JSON.stringify(t))}`)),rounded:"",icon:"edit"},null,8,["onClick"])):U("",!0),e.user!=null&&t.author.id==e.user.id?(c(),p(v,{key:1,flat:"",onClick:f=>(e.confirm=!0,e.idBul(`${encodeURIComponent(JSON.stringify(t))}`)),rounded:"",icon:"delete",color:"red"},null,8,["onClick"])):U("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1024),s("div",Ee,[s("span",Te,g(t.created_at),1),s("p",null,[s("b",He,g(t.author.username),1),s("span",Oe,g(t.body),1)])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["name"]))),128))]),_:1},8,["onLoad"]),a(F,{modelValue:e.edit,"onUpdate:modelValue":o[4]||(o[4]=t=>e.edit=t),persistent:""},{default:l(()=>[a(L,{style:{"min-width":"30%"}},{default:l(()=>[a(q,null,{default:l(()=>o[7]||(o[7]=[s("div",{class:"text-h6"},"Update the Post",-1)])),_:1}),a(q,{align:"center",class:"q-pt-none"},{default:l(()=>[a(se,{outlined:"",autogrow:"",type:"textarea",label:"Body",modelValue:e.postData.body,"onUpdate:modelValue":o[0]||(o[0]=t=>e.postData.body=t),autofocus:""},null,8,["modelValue"]),a(ie,{filled:"","bottom-slots":"",modelValue:e.postData.image,"onUpdate:modelValue":o[3]||(o[3]=t=>e.postData.image=t),accept:"image/*",label:"Add image",counter:""},{prepend:l(()=>[a(X,{name:"cloud_upload",onClick:o[1]||(o[1]=te(()=>{},["stop","prevent"]))})]),append:l(()=>[a(X,{name:"close",onClick:o[2]||(o[2]=te(t=>e.form.image=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:l(()=>[e.res?(c(),J("p",Fe,[s("b",null,g(e.res),1)])):U("",!0),e.error?(c(),J("p",Re,[s("b",null,g(e.error),1)])):U("",!0)]),_:1},8,["modelValue"])]),_:1}),a(M,{align:"right",class:"text-primary"},{default:l(()=>[j(a(v,{flat:"",class:"text-grey-8",label:"Cancel"},null,512),[[R]]),a(v,{color:"brown",onClick:e.updatePost},{default:l(()=>[o[8]||(o[8]=C("Update post ")),e.loading?(c(),p(fe,{key:0,class:"q-ml-sm"})):U("",!0)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(F,{modelValue:e.confirm,"onUpdate:modelValue":o[5]||(o[5]=t=>e.confirm=t),persistent:""},{default:l(()=>[a(L,null,{default:l(()=>[a(q,{class:"row items-center"},{default:l(()=>[a(Y,{icon:"error",color:"red","text-color":"white"}),o[9]||(o[9]=s("span",{class:"q-ml-sm"},"Are you sure you want to delete the post?",-1))]),_:1}),a(M,{align:"right"},{default:l(()=>[j(a(v,{squre:"",label:"Cancel",color:"grey"},null,512),[[R]]),a(v,{squre:"",label:"Yes, Delete",onClick:e.deletePost,color:"red"},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(F,{modelValue:e.alert,"onUpdate:modelValue":o[6]||(o[6]=t=>e.alert=t)},{default:l(()=>[a(L,null,{default:l(()=>[a(q,null,{default:l(()=>o[10]||(o[10]=[s("div",{class:"text-h6"},"Alert",-1)])),_:1}),a(q,{class:"q-pt-none"},{default:l(()=>o[11]||(o[11]=[C(" Deleted post ")])),_:1}),a(M,{align:"right"},{default:l(()=>[j(a(v,{flat:"",label:"OK",color:"primary"},null,512),[[R]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}const tt=Ce(Be,[["render",ze],["__scopeId","data-v-129c9a3e"],["__file","IndexPage.vue"]]);export{tt as default};
